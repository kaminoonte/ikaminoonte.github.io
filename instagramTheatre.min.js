function instagramFetch(e){var t=e.accessToken,i={access_token:t};fetchCMD(i,e)}function fetchCMD(e,t){var i="";if("user"==t.mode)i="https://api.instagram.com/v1/users/"+t.userID+"/media/recent/?callback=?";else if("popular"==t.mode)i="https://api.instagram.com/v1/media/popular?callback=?";else if("location"==t.mode)i="https://api.instagram.com/v1/locations/"+t.locationID+"/media/recent/?callback=?";else{if("multiuser"==t.mode){var n=t.userID;return n=n.split(","),jQuery.each(n,function(s){i="https://api.instagram.com/v1/users/"+n[s]+"/media/recent/?callback=?",jQuery.getJSON(i,e,function(e){onPhotoLoaded(e,t,"off")})}),!1}var s=t.tag.replace(/ /g,"");i="https://api.instagram.com/v1/tags/"+s+"/media/recent?callback=?"}jQuery.getJSON(i,e,function(e){onPhotoLoaded(e,t)})}function instagramUserSearch(e){var t=e.accessToken,i=e.user,n={access_token:t,q:i};userSearchCMD(n,e)}function userSearchCMD(e,t){var i="https://api.instagram.com/v1/users/search?callback=?";jQuery.getJSON(i,e,function(e){onUserLoaded(e,t)})}function onUserLoaded(e){if(200==e.meta.code){var t=e.data;if(t.length>0)for(var i in t){var n=t[i],s="";s='<div class="instagram-user-all" id="p'+n.id+'" title="'+n.username+'" rel="'+n.id+'">',s+="<img src='"+n.profile_picture+"' />",s+="<span class='instagram-username'>"+n.username+"</span>",s+="<span class='instagram-fullname'>"+n.full_name+"</span>",s+="</div>",jQuery(s).appendTo(ibObj)}}}function instagramTagsLoadMore(e){var t=e.accessToken,i={access_token:t,max_tag_id:instagramBrowserNextMax};if("tag"==e.mode)var n=e.tag.replace(/ /g,"");loadMoreCMD(e,i,n)}function loadMoreCMD(e,t,i){var n="https://api.instagram.com/v1/tags/"+i+"/media/recent?callback=?";jQuery.getJSON(n,t,function(t){onPhotoLoaded(t,e)})}function instagramUsersLoadMore(e){var t=e.accessToken,i={access_token:t,max_id:instagramBrowserNextMax};loadMoreUsersCMD(e,i)}function loadMoreUsersCMD(e,t){var i="https://api.instagram.com/v1/users/"+e.userID+"/media/recent/?callback=?";jQuery.getJSON(i,t,function(t){onPhotoLoaded(t,e)})}function instagramLocationLoadMore(e){var t=e.accessToken,i={access_token:t,max_id:instagramBrowserNextMax};loadMoreLocationsCMD(e,i)}function loadMoreLocationsCMD(e,t){var i="https://api.instagram.com/v1/locations/"+e.locationID+"/media/recent/?callback=?";jQuery.getJSON(i,t,function(t){onPhotoLoaded(t,e)})}function onPhotoLoaded(e,t,i){if(""!=t.galleryFullscreenPhotos&&"fullscreen"==t.galleryMode)return displayGalleryByType(t),!1;if(instagramBrowserNextMax=e.pagination?e.pagination.next_max_id?e.pagination.next_max_id:"Empty":"Empty",200==e.meta.code){var n=e.data;if(""!=ibObj.html())var s=!0;else var s=!1;if(n.length>0){for(var o in n){var r=n[o],a="",l="";l=r.caption?r.caption.text:"Instagram Photo",null==r.link&&(r.link="http://instagram.com/p/"),a='<a class="instagram-photo" href="'+r.images.standard_resolution.url+'" data-url="'+r.link+'" data-name="'+r.user.full_name+'" id="p'+r.id+'" title="'+l+" ("+r.likes.count+" Likes) &lt;a href=&quot;"+r.link+'&quot;&gt;View Photo&lt;/a&gt; " data-created="'+r.created_time+'" rel="group">',a+='<img src="'+r.images.standard_resolution.url+'" width="100%">',a+="</a>",jQuery(a).appendTo(ibObj)}var d=jQuery(".instagram-photo").size()-1;0==s&&jQuery(".instagram-photo").hide(),jQuery(".instagram-photo").each(function(e){currentPhoto=jQuery(this),currentPhoto.delay(t.delayInterval*e).fadeIn(t.speed),jQuery("#seachInstagramLoadMoreContainer").remove(),e==d&&"Empty"!=instagramBrowserNextMax&&jQuery('<div id="seachInstagramLoadMoreContainer"><a class="seachInstagramLoadMore btn btn-inverse">Load More</a></div>').appendTo(ibObj),"off"==i&&jQuery("#seachInstagramLoadMoreContainer").remove()}),displayGalleryByType(t)}else alert("empty")}else alert(e.meta.error_message)}function displayGalleryByType(e){function t(){s=s>=n.length-1?0:s+1,n[s]?(jQuery.backstretch(n[s].path),i(s)):s-=1}function i(t){if(""!=e.galleryFullscreenPhotos)var i=n[t].dateTime;else{var i=parseInt(n[t].dateTime);i=new Date(1e3*i),i=dateFormat(i,"dddd, mmmm dS, yyyy, h:MM:ss TT")}var s="<h3>"+n[t].title+"</h3>";s+="<em>"+i+"</em>",s+="<p>"+n[t].caption+"</p>",jQuery(".caption-container .content").html(s)}if("fullscreen"==e.galleryMode){var n=[];""!=e.galleryFullscreenPhotos?jQuery(e.galleryFullscreenPhotos+" img").each(function(e){var t={path:jQuery(this).attr("src"),title:jQuery(this).attr("title"),dateTime:jQuery(this).attr("date-created"),caption:jQuery(this).attr("rel")};n[e]=t}):(jQuery(".instagram-photo").each(function(e){var t={path:jQuery(this).find("img").attr("src"),title:jQuery(this).attr("data-name"),dateTime:jQuery(this).attr("data-created"),caption:jQuery(this).attr("title")};n[e]=t}),ibObj.hide());var s=0;jQuery.backstretch(n[s].path,{speed:500});var o=setInterval(t,5e3);jQuery(".photo-nav a.next").click(function(){s=s>=n.length-1?0:s+1,n[s]?(jQuery.backstretch(n[s].path),i(s),clearInterval(o),o=setInterval(t,7e3)):s-=1}),jQuery(".photo-nav a.prev").click(function(){s=s>=1?s-1:n.length-1,n[s]?(jQuery.backstretch(n[s].path),i(s),clearInterval(o),o=setInterval(t,7e3)):s+=1}),i(s)}"thumbnail"==e.galleryMode&&(jQuery(".caption-container").hide(),jQuery(".photo-nav").hide(),jQuery(ibObj).show(),startFancybox()),"list"==e.galleryMode&&(jQuery(".caption-container").hide(),jQuery(".photo-nav").hide(),jQuery(ibObj).show().addClass("list"),startFancybox())}function startFancybox(){jQuery(ibObj).find("a.instagram-photo").fancybox({nextEffect:"fade",prevEffect:"fade",overlayOpacity:.8,overlayColor:"#000000",arrows:!1,titlePosition:"inside"})}var ibObj,instagramBrowserNextMax;jQuery.fn.instagramTheatre=function(e){var t={mode:"popular",accessToken:"3794301.f59def8.e08bcd8b10614074882b2d1b787e2b6f",userID:"1138644",speed:700,delayInterval:80,tag:"sports",locationID:"41354",galleryMode:"thumbnail",galleryFullscreenPhotos:""};return ibObj=jQuery(this),jQuery.extend(t,e),this.each(function(){jQuery(document).ready(function(){instagramFetch(t),jQuery(document).on("click",".seachInstagramLoadMore",function(){"tag"==t.mode?instagramTagsLoadMore(t):"user"==t.mode?instagramUsersLoadMore(t):"location"==t.mode&&instagramLocationLoadMore(t)}),jQuery("#searchByTag .submit").click(function(){ibObj.html("");var e=t;return e.mode="tag",e.tag=jQuery("input.searchTag").val().replace(/ /g,""),""==e.tag?(alert("Please enter a valid hashtag."),!1):(instagramFetch(e),!1)}),jQuery("#searchByUser .submit").click(function(){ibObj.html("");var e=t;return e.mode="user",e.user=jQuery("input.searchUser").val().replace(/ /g,""),""==e.user?(alert("Please enter a valid username."),!1):(instagramUserSearch(e),!1)}),jQuery("#searchByLocation .submit").click(function(){ibObj.html("");var e=t;return e.mode="location",e.locationID=jQuery("select.searchLocation").val().replace(/ /g,""),""==e.locationID?(alert("Please enter a valid location."),!1):(instagramFetch(e),!1)}),jQuery(document).on("click",".instagram-user-all",function(){ibObj.html("");var e=t;e.mode="user",e.userID=jQuery(this).attr("rel"),instagramFetch(e)}),jQuery(document).on({mouseenter:function(){var e=jQuery(this);e.height();var t=e.width(),i=parseInt(e.attr("data-created"));i=new Date(1e3*i),i=dateFormat(i,"dddd, mmmm dS, yyyy, h:MM:ss TT");var n='<div class="instagram-hover-cover">';n+="<h3>"+e.attr("data-name")+"</h3>",n+="<em>"+i+"</em>",n+="<p>"+e.attr("title").substring(0,196)+"</p>",n+="</div>",e.append(n),jQuery(".instagram-hover-cover").hide().css({height:"164px",width:t}).slideDown("fast")},mouseleave:function(){var e=jQuery(this);e.find(".instagram-hover-cover").delay(500).slideUp("fast",function(){jQuery(this).remove()})}},".list .instagram-photo")})})};